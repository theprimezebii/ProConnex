<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Browse Jobs | ProConnex</title>

  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/css/browse-jobs.css">

  <!-- AOS Animation -->
  <link href="https://unpkg.com/aos@2.3.4/dist/aos.css" rel="stylesheet" />
</head>
<body>
  <%- include('partials/header', { user: user }) %>
  <%- include('partials/joinModal') %>

  <main class="browse-jobs-page" data-aos="fade-up">
    <div class="browse-header">
      <h1>Explore Freelance Jobs</h1>
      <p>Browse opportunities that match your skills and interests</p>
    </div>

    <!-- Dynamically add class for 2-column layout if jobs > 1 -->
   <div class="job-listings-grid full-width <%= jobs.length > 1 ? 'two-or-more' : '' %>">
      <% if (jobs && jobs.length > 0) { %>
        <% jobs.forEach(job => { %>
          <div class="job-card" data-aos="fade-up">
            <div class="job-content">
              <h2><%= job.title %></h2>
              <p><%= job.description.length > 160 ? job.description.substring(0, 160) + '...' : job.description %></p>

              <ul class="job-meta">
                <li><strong>Budget:</strong> $<%= job.budget %></li>
                <li><strong>Deadline:</strong> <%= job.deadline %></li>
                <li><strong>Category:</strong> <%= job.category %></li>
                <li><strong>Skills:</strong> <%= job.skills %></li>
              </ul>
            </div>

            <div class="job-actions">
              <a href="/job-details/<%= job.id %>" class="btn btn-outline">View Details</a>

              <% if (user) { %>
                <% if (job.user_id !== user.id) { %>
                  <a href="/apply-job/<%= job.id %>" class="btn btn-primary">Apply</a>
                <% } else { %>
                  <span class="btn btn-disabled">Your Job</span>
                <% } %>
              <% } else { %>
                <button onclick="openJoinModal()" class="btn btn-primary">Login to Apply</button>
              <% } %>
            </div>
          </div>
        <% }) %>
      <% } else { %>
        <p class="no-jobs">No jobs available at the moment. Check back soon!</p>
      <% } %>
    </div>
  </main>

  <%- include('partials/footer', { user: user, currentPage: currentPage }) %>

  <script src="/js/main.js"></script>
  <script src="https://unpkg.com/aos@2.3.4/dist/aos.js"></script>
  <script>
    AOS.init({ duration: 800, once: true });
  </script>
</body>
</html>
